(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2313:function(e,r,t){Promise.resolve().then(t.bind(t,5283))},5283:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return f}});var n=t(7437),i=t(2265);async function o(){try{let e=await fetch("/bff/user",{credentials:"include",headers:{"X-CSRF":"1"}});if(e.ok){let r=await e.json();if(Array.isArray(r)&&r.length>0)return{isAuthenticated:!0,user:r,isLoading:!1}}return{isAuthenticated:!1,user:null,isLoading:!1}}catch(e){return console.error("Authentication check failed:",e),{isAuthenticated:!1,user:null,isLoading:!1}}}function s(e,r){let t=e.find(e=>e.type===r);return t?t.value:null}function l(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[r,t]=(0,i.useState)({isAuthenticated:!1,user:null,isLoading:!0});return(0,i.useEffect)(()=>{(async()=>{let r=await o();t(r),!e||r.isAuthenticated||r.isLoading||function(){let e=window.location.pathname+window.location.search;window.location.href="/bff/login?returnUrl=".concat(encodeURIComponent(e))}()})()},[e]),r}function a(e){let{children:r,loadingComponent:t}=e,{isAuthenticated:i,isLoading:o}=l(!0);return o?(0,n.jsx)(n.Fragment,{children:t||(0,n.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center",marginTop:"4rem"},children:[(0,n.jsx)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #0070f3",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,n.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Loading..."}),(0,n.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]})}):i?(0,n.jsx)(n.Fragment,{children:r}):null}let d=[];function c(e){let{claims:r}=e,t=s(r,"name")||s(r,"preferred_username")||s(r,"email")||"User",i=async()=>{for(let e of[...d])try{let r=await fetch("".concat(e,"/api/auth/silent-logout"),{method:"POST",credentials:"include"});200!==r.status&&console.warn("Logout failed for ".concat(e," with status: ").concat(r.status))}catch(r){console.error("Error during logout for ".concat(e,":"),r)}!function(e){let r=s(e,"id_token"),t=s(e,"sid"),n="/bff/logout",i=new URLSearchParams;r&&i.append("id_token_hint",r),t&&i.append("sid",t),i.toString()&&(n+="?".concat(i.toString())),window.location.href=n}(r)};return(0,n.jsx)("table",{style:{borderCollapse:"collapse",backgroundColor:"#f8f8f8",borderRadius:"8px",padding:"0.5rem",width:"100%"},children:(0,n.jsxs)("tbody",{children:[(0,n.jsx)("tr",{children:(0,n.jsx)("td",{style:{padding:"0.25rem 0",fontSize:"1rem",color:"#6c757d"},children:(0,n.jsx)("strong",{style:{marginLeft:"0.5rem",fontSize:"1rem",color:"#343a40"},children:t})})}),(0,n.jsx)("tr",{children:(0,n.jsx)("td",{style:{padding:"0.25rem 0"},children:(0,n.jsx)("button",{onClick:i,style:{padding:"0.5rem 1rem",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"500",width:"100%"},children:"Logout"})})})]})})}var u=t(3145);let m=e=>{let{microservice:r,isExpanded:t,onToggle:i,handleMenuItemClick:o,loading:s}=e;return(0,n.jsxs)("div",{style:{marginBottom:"1.5rem",border:"1px solid #ddd",borderRadius:"5px"},children:[(0,n.jsxs)("button",{onClick:i,style:{width:"100%",textAlign:"left",padding:"0.75rem 1rem",backgroundColor:t?"#e0f2f1":"#f8f8f8",border:"none",borderBottom:t?"1px solid #ddd":"none",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",color:"#2563eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.name,(0,n.jsx)("span",{style:{fontSize:"0.8rem",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"â–¼ "})]}),t&&(0,n.jsx)("div",{style:{padding:"1rem"},children:r.managementAreas.map(e=>(0,n.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,n.jsx)("h4",{style:{margin:"0.5rem 0",fontSize:"1rem",color:"#4b5563"},children:e.name}),(0,n.jsx)("ul",{style:{listStyle:"none",paddingLeft:"1rem",margin:0},children:e.menuItems.map(t=>(0,n.jsx)("li",{style:{marginBottom:"0.5rem"},children:(0,n.jsxs)("a",{href:"#",onClick:n=>{n.preventDefault(),s||o({...t,managementAreaName:e.name,microserviceName:r.name,baseURL:r.baseURL})},style:{color:s?"#ccc":"#10b981",textDecoration:"none",cursor:s?"not-allowed":"pointer",fontWeight:"500"},children:[t.taskName," ",s&&"..."]})},t.taskName))})]},e.name))})]})};function f(){return(0,n.jsx)(a,{children:(0,n.jsx)(h,{})})}function h(){let{user:e}=l(!1),[r,t]=(0,i.useState)(!1),[o,s]=(0,i.useState)(null),[a,f]=(0,i.useState)(null),[h,g]=(0,i.useState)(0),p=e=>{g(e===h?-1:e)},x=e=>{var r;s(null),t(!0);let n=document.getElementById("microservice-frame");if(!n){s("Internal error: iframe not found."),t(!1);return}if(!e.baseURL){s("Internal error: baseURL not found for the selected microservice."),t(!1);return}r=e.baseURL,d.includes(r)||d.push(r);let i="".concat(e.baseURL,"/api/auth/silent-login?returnUrl=").concat(encodeURIComponent(e.urlRelativePath));n.src=i,n.onload=()=>{t(!1)}},y=async()=>{try{let e=await fetch("/bff/api/Menu/Authorized",{credentials:"include"});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();f(r)}catch(e){console.error("Failed to load menu:",e)}};return((0,i.useEffect)(()=>{y()},[]),e)?(0,n.jsxs)("div",{style:{fontFamily:"system-ui, sans-serif",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[(0,n.jsxs)("header",{style:{display:"grid",gridTemplateColumns:"100px 1fr auto",alignItems:"center",padding:"1rem 2rem",borderBottom:"1px solid #ccc",backgroundColor:"#f8f8f8"},children:[(0,n.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,n.jsx)(u.default,{src:"/res/PAS.png",alt:"Platform Administration System Logo",style:{height:"100px",width:"auto",borderRadius:"12px"}})}),(0,n.jsx)("h1",{style:{margin:1,marginLeft:"2rem",fontSize:"2rem"},children:"Platform Administration System"}),(0,n.jsx)(c,{claims:e})]}),(0,n.jsxs)("main",{style:{display:"grid",gridTemplateColumns:"300px 1fr",flexGrow:1,overflow:"hidden"},children:[(0,n.jsx)("div",{style:{padding:"1rem 2rem",borderRight:"1px solid #ccc",overflowY:"auto"},children:null==a?void 0:a.microservices.map((e,t)=>(0,n.jsx)(m,{microservice:e,isExpanded:t===h,onToggle:()=>p(t),handleMenuItemClick:x,loading:r},e.name))}),(0,n.jsxs)("div",{style:{padding:"1rem",overflow:"hidden",display:"flex",flexDirection:"column"},children:[o&&(0,n.jsxs)("div",{style:{padding:"1rem",marginBottom:"1rem",backgroundColor:"#fee",color:"#c00",borderRadius:"5px",border:"1px solid #fcc"},children:[(0,n.jsx)("strong",{children:"Error:"})," ",o]}),(0,n.jsx)("div",{style:{flexGrow:1},children:(0,n.jsx)("iframe",{id:"microservice-frame",style:{width:"100%",height:"100%",border:"1px solid #ccc",borderRadius:"5px"}})})]})]})]}):null}}},function(e){e.O(0,[145,971,117,744],function(){return e(e.s=2313)}),_N_E=e.O()}]);