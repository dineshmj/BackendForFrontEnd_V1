(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3932:function(e,n,t){Promise.resolve().then(t.bind(t,6308))},6308:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var r=t(7437),i=t(2265);async function o(){try{let e=await fetch("/bff/user",{credentials:"include",headers:{"X-CSRF":"1"}});if(e.ok){let n=await e.json();if(Array.isArray(n)&&n.length>0)return{isAuthenticated:!0,user:n,isLoading:!1}}return{isAuthenticated:!1,user:null,isLoading:!1}}catch(e){return console.error("Authentication check failed:",e),{isAuthenticated:!1,user:null,isLoading:!1}}}function s(e,n){let t=e.find(e=>e.type===n);return t?t.value:null}function l(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[n,t]=(0,i.useState)({isAuthenticated:!1,user:null,isLoading:!0});return(0,i.useEffect)(()=>{(async()=>{let n=await o();t(n),!e||n.isAuthenticated||n.isLoading||function(){let e=window.location.pathname+window.location.search;window.location.href="/bff/login?returnUrl=".concat(encodeURIComponent(e))}()})()},[e]),n}function d(e){let{children:n,loadingComponent:t}=e,{isAuthenticated:i,isLoading:o}=l(!0);return o?(0,r.jsx)(r.Fragment,{children:t||(0,r.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center",marginTop:"4rem"},children:[(0,r.jsx)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #0070f3",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,r.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Loading..."}),(0,r.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]})}):i?(0,r.jsx)(r.Fragment,{children:n}):null}function a(e){let{claims:n}=e;return(0,r.jsx)("table",{style:{borderCollapse:"collapse",backgroundColor:"#f8f8f8",borderRadius:"8px",padding:"0.5rem",width:"100%"},children:(0,r.jsx)("tbody",{children:(0,r.jsx)("tr",{children:(0,r.jsx)("td",{style:{padding:"0.25rem 0"},children:(0,r.jsx)("button",{onClick:()=>(function(e){alert("Logging out...");let n=s(e,"id_token"),t=s(e,"sid"),r="/bff/logout",i=new URLSearchParams;n&&i.append("id_token_hint",n),t&&i.append("sid",t),i.toString()&&(r+="?".concat(i.toString())),alert("Logging out..."+r),window.location.href=r})(n),style:{padding:"0.5rem 1rem",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"500",width:"100%"},children:"Logout"})})})})})}var c=e=>{let{products:n}=e;return n&&0!==n.length?(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem",marginTop:"2rem"},children:n.map(e=>(0,r.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"1rem",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,r.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.5rem"},children:e.name}),(0,r.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,r.jsx)("strong",{children:"Price:"})," $",e.price.toFixed(2)]}),(0,r.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,r.jsx)("strong",{children:"Category:"})," ",e.categoryName]}),(0,r.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,r.jsx)("strong",{children:"Stock:"})," ",e.stockQuantity]})]},e.id))}):(0,r.jsx)("p",{children:"No items found."})};function u(){let{user:e}=l(!1),[n,t]=(0,i.useState)(null),[o,s]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),h=async()=>{u(null),s(!0);try{let e=await fetch("/bff/products",{credentials:"include",headers:{"X-CSRF":"1"}});if(!e.ok){u("Failed to load products");return}let n=await e.json();t(n)}catch(e){console.error(e),u("Failed to load products")}finally{s(!1)}};return((0,i.useEffect)(()=>{e&&h()},[e]),e)?(0,r.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui",maxWidth:"900px",margin:"0 auto"},children:[(0,r.jsx)("h1",{children:"View All Products"}),(0,r.jsx)(a,{claims:e}),o&&(0,r.jsx)("p",{children:"Loading products..."}),d&&(0,r.jsx)("div",{style:{marginTop:"1rem",color:"red"},children:d}),n&&(0,r.jsx)(c,{products:n.products})]}):null}function h(){return(0,r.jsx)(d,{children:(0,r.jsx)(u,{})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3932)}),_N_E=e.O()}]);