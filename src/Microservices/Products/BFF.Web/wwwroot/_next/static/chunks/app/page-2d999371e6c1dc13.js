(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9489:function(e,t,n){Promise.resolve().then(n.bind(n,2206))},2206:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),i=n(2265);async function o(){try{let e=await fetch("/bff/user",{credentials:"include",headers:{"X-CSRF":"1"}});if(e.ok){let t=await e.json();if(Array.isArray(t)&&t.length>0)return{isAuthenticated:!0,user:t,isLoading:!1}}return{isAuthenticated:!1,user:null,isLoading:!1}}catch(e){return console.error("Authentication check failed:",e),{isAuthenticated:!1,user:null,isLoading:!1}}}function d(e,t){let n=e.find(e=>e.type===t);return n?n.value:null}function s(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,n]=(0,i.useState)({isAuthenticated:!1,user:null,isLoading:!0});return(0,i.useEffect)(()=>{(async()=>{let t=await o();n(t),!e||t.isAuthenticated||t.isLoading||function(){let e=window.location.pathname+window.location.search;window.location.href="/bff/login?returnUrl=".concat(encodeURIComponent(e))}()})()},[e]),t}function l(e){let{children:t,loadingComponent:n}=e,{isAuthenticated:i,isLoading:o}=s(!0);return o?(0,r.jsx)(r.Fragment,{children:n||(0,r.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center",marginTop:"4rem"},children:[(0,r.jsx)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #0070f3",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,r.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Loading..."}),(0,r.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]})}):i?(0,r.jsx)(r.Fragment,{children:t}):null}function c(e){let{claims:t}=e;return(0,r.jsx)("table",{style:{borderCollapse:"collapse",backgroundColor:"#f8f8f8",borderRadius:"8px",padding:"0.5rem",width:"100%"},children:(0,r.jsx)("tbody",{children:(0,r.jsx)("tr",{children:(0,r.jsx)("td",{style:{padding:"0.25rem 0"},children:(0,r.jsx)("button",{onClick:()=>(function(e){alert("Logging out...");let t=d(e,"id_token"),n=d(e,"sid"),r="/bff/logout",i=new URLSearchParams;t&&i.append("id_token_hint",t),n&&i.append("sid",n),i.toString()&&(r+="?".concat(i.toString())),alert("Logging out..."+r),window.location.href=r})(t),style:{padding:"0.5rem 1rem",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"500",width:"100%"},children:"Logout"})})})})})}function a(){let{user:e}=s(!1),[t,n]=(0,i.useState)(null),[o,d]=(0,i.useState)(!1),[l,a]=(0,i.useState)(null);if(!e)return null;let u=async()=>{a(null),d(!0);try{let e=await fetch("/bff/products",{credentials:"include",headers:{"X-CSRF":"1"}});if(!e.ok){a("Failed to load products");return}let r=await e.json();n(r),alert("Fetched products: "+JSON.stringify(t))}catch(e){console.error(e),a("Failed to load products")}finally{d(!1)}};return(0,r.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui",maxWidth:"900px",margin:"0 auto"},children:[(0,r.jsx)("h1",{children:"Products Microservice"}),(0,r.jsx)("button",{onClick:u,disabled:o,style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:o?"#999":"#2563eb",color:"white",border:"none",borderRadius:"6px",cursor:o?"not-allowed":"pointer"},children:o?"Loadingâ€¦":"Load Products"}),(0,r.jsx)(c,{claims:e}),l&&(0,r.jsx)("div",{style:{marginTop:"1rem",color:"red"},children:l}),t&&(0,r.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,r.jsx)("h2",{children:"Products"}),(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{background:"#eee"},children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Price"}),(0,r.jsx)("th",{children:"Category"}),(0,r.jsx)("th",{children:"Stock"})]})}),(0,r.jsx)("tbody",{children:t.products&&t.products.length>0?t.products.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:e.name}),(0,r.jsxs)("td",{children:["$",e.price]}),(0,r.jsx)("td",{children:e.categoryName}),(0,r.jsx)("td",{children:e.stockQuantity})]},e.id)):(0,r.jsx)("p",{children:"No items found."})})]})})]})]})}function u(){return(0,r.jsx)(l,{children:(0,r.jsx)(a,{})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9489)}),_N_E=e.O()}]);