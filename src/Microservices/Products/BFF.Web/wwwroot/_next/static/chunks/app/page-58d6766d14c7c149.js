(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5151:function(e,n,r){Promise.resolve().then(r.bind(r,2206))},2206:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return c}});var t=r(7437),i=r(2265);async function o(){try{let e=await fetch("/bff/user",{credentials:"include",headers:{"X-CSRF":"1"}});if(e.ok){let n=await e.json();if(Array.isArray(n)&&n.length>0)return{isAuthenticated:!0,user:n,isLoading:!1}}return{isAuthenticated:!1,user:null,isLoading:!1}}catch(e){return console.error("Authentication check failed:",e),{isAuthenticated:!1,user:null,isLoading:!1}}}function s(e,n){let r=e.find(e=>e.type===n);return r?r.value:null}function a(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[n,r]=(0,i.useState)({isAuthenticated:!1,user:null,isLoading:!0});return(0,i.useEffect)(()=>{(async()=>{let n=await o();r(n),!e||n.isAuthenticated||n.isLoading||function(){let e=window.location.pathname+window.location.search;window.location.href="/bff/login?returnUrl=".concat(encodeURIComponent(e))}()})()},[e]),n}function l(e){let{children:n,loadingComponent:r}=e,{isAuthenticated:i,isLoading:o}=a(!0);return o?(0,t.jsx)(t.Fragment,{children:r||(0,t.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center",marginTop:"4rem"},children:[(0,t.jsx)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #0070f3",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,t.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Loading..."}),(0,t.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]})}):i?(0,t.jsx)(t.Fragment,{children:n}):null}function d(e){let{claims:n}=e,r=s(n,"name")||s(n,"preferred_username")||s(n,"email")||"User";return(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"8px",marginBottom:"2rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{style:{fontSize:"0.9rem",color:"#6c757d"},children:"Logged in as:"}),(0,t.jsx)("strong",{style:{marginLeft:"0.5rem",fontSize:"1.1rem"},children:r})]}),(0,t.jsx)("button",{onClick:()=>(function(e){let n=s(e,"id_token"),r=s(e,"sid"),t="/bff/logout",i=new URLSearchParams;n&&i.append("id_token_hint",n),r&&i.append("sid",r),i.toString()&&(t+="?".concat(i.toString())),window.location.href=t})(n),style:{padding:"0.5rem 1rem",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"500"},children:"Logout"})]})}function c(){return(0,t.jsx)(l,{children:(0,t.jsx)(u,{})})}function u(){let{user:e}=a(!1),[n,r]=(0,i.useState)(!1),[o,s]=(0,i.useState)(null),[l,c]=(0,i.useState)(null),u=e=>{s(null),r(!0);let n=document.getElementById("microservice-frame");if(!n){s("Internal error: iframe not found."),r(!1);return}n.src="/bff/forward".concat(e.urlRelativePath),n.onload=()=>{r(!1)}},m=async()=>{try{let e=await fetch("/bff/api/Menu/Authorized",{credentials:"include"});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=await e.json();c(n)}catch(n){let e=n instanceof Error?n.message:"An unknown error occurred";console.error("Failed to load menu:",n),alert("Failed to load menu: ".concat(e))}};return((0,i.useEffect)(()=>{m()},[]),e)?(0,t.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",maxWidth:"1200px",margin:"0 auto"},children:[(0,t.jsx)("h1",{style:{marginBottom:"1.5rem"},children:"Platform Administration System"}),(0,t.jsx)(d,{claims:e}),o&&(0,t.jsxs)("div",{style:{padding:"1rem",marginTop:"1rem",backgroundColor:"#fee",color:"#c00",borderRadius:"5px",border:"1px solid #fcc"},children:[(0,t.jsx)("strong",{children:"Error:"})," ",o]}),(0,t.jsx)("div",{style:{marginTop:"2rem",display:"flex",gap:"2rem"},children:null==l?void 0:l.microservices.map(e=>(0,t.jsxs)("div",{style:{border:"1px solid #ddd",padding:"1rem",borderRadius:"5px",minWidth:"250px"},children:[(0,t.jsx)("h3",{style:{marginTop:0,color:"#2563eb"},children:e.name}),e.managementAreas.map(e=>(0,t.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,t.jsx)("h4",{style:{margin:"0.5rem 0",fontSize:"1rem",color:"#4b5563"},children:e.name}),(0,t.jsx)("ul",{style:{listStyle:"none",paddingLeft:"1rem",margin:0},children:e.menuItems.map(e=>(0,t.jsx)("li",{style:{marginBottom:"0.5rem"},children:(0,t.jsxs)("a",{href:"#",onClick:r=>{r.preventDefault(),n||u(e)},style:{color:n?"#ccc":"#10b981",textDecoration:"none",cursor:n?"not-allowed":"pointer",fontWeight:"500"},children:[e.taskName," ",n&&"..."]})},e.taskName))})]},e.name))]},e.name))}),(0,t.jsx)("div",{style:{marginTop:"3rem"},children:(0,t.jsx)("iframe",{id:"microservice-frame",style:{width:"100%",height:"600px",border:"1px solid #ccc",borderRadius:"5px"}})})]}):null}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5151)}),_N_E=e.O()}]);