(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8239:function(e,r,t){Promise.resolve().then(t.bind(t,2557))},8229:function(e,r,t){"use strict";t.d(r,{a:function(){return a}});var n=t(7437),i=t(3542),s=t(8365);function a(e){let{children:r,loadingComponent:t}=e,{isAuthenticated:a,isLoading:d,showLoginMessage:o}=(0,i.a)(!0);if(d)return(0,n.jsx)(n.Fragment,{children:t||(0,n.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",textAlign:"center",marginTop:"4rem"},children:[(0,n.jsx)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #0070f3",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,n.jsx)("p",{style:{marginTop:"1rem",color:"#666"},children:"Loading..."}),(0,n.jsx)("style",{children:"\n              @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n              }\n            "})]})});if(!a){if(o){let e=s.v.D;return(0,n.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui",textAlign:"center"},children:[(0,n.jsx)("h1",{children:"Authentication Required"}),(0,n.jsxs)("p",{children:["User is not authenticated. Please login from",(0,n.jsx)("a",{href:e,style:{marginLeft:"0.5rem"},children:"Platform Management System"}),"."]})]})}return null}return(0,n.jsx)(n.Fragment,{children:r})}},3542:function(e,r,t){"use strict";t.d(r,{a:function(){return s}});var n=t(2265);async function i(){try{let e=await fetch("/bff/user",{credentials:"include",headers:{"X-CSRF":"1"}});if(e.ok){let r=await e.json();if(Array.isArray(r)&&r.length>0)return{isAuthenticated:!0,user:r,isLoading:!1}}return{isAuthenticated:!1,user:null,isLoading:!1}}catch(e){return console.error("Authentication check failed:",e),{isAuthenticated:!1,user:null,isLoading:!1}}}function s(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[r,t]=(0,n.useState)({isAuthenticated:!1,user:null,isLoading:!0}),[s,a]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{(async()=>{let r=await i();t(r),!e||r.isAuthenticated||r.isLoading||a(!0)})()},[e]),{...r,showLoginMessage:s}}},4201:function(e,r,t){"use strict";t.d(r,{t2:function(){return i}});var n=t(1455);let i=(0,n.hg)("products/fetchProducts",async(e,r)=>{let{rejectWithValue:t}=r;try{let e=new AbortController,r=setTimeout(()=>e.abort(),1e4),n=await fetch("/bff/products",{credentials:"include",headers:{"X-CSRF":"1"},signal:e.signal});if(clearTimeout(r),!n.ok)return t("Failed to load products: Status ".concat(n.status));return await n.json()}catch(e){if(e instanceof Error&&"AbortError"===e.name)return t("Products fetch timed out");return console.error(e),t("Network error fetching products")}}),s=(0,n.oM)({name:"products",initialState:{data:null,loading:!1,error:null,hasLoaded:!1},reducers:{clearProductsError:e=>{e.error=null}},extraReducers:e=>{e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,r)=>{e.loading=!1,e.data=r.payload.products,e.hasLoaded=!0}).addCase(i.rejected,(e,r)=>{e.loading=!1,e.error=r.payload||"An unknown error occurred during fetch.",e.data=null})}}),{clearProductsError:a}=s.actions;r.ZP=s.reducer},2557:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return u}});var n=t(7437),i=t(2265),s=t(8229),a=t(3542),d=e=>{let{products:r}=e;return r&&0!==r.length?(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem",marginTop:"2rem"},children:r.map(e=>(0,n.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"1rem",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.5rem"},children:e.name}),(0,n.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,n.jsx)("strong",{children:"Price:"})," $",e.price.toFixed(2)]}),(0,n.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,n.jsx)("strong",{children:"Category:"})," ",e.categoryName]}),(0,n.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,n.jsx)("strong",{children:"Stock:"})," ",e.stockQuantity]})]},e.id))}):(0,n.jsx)("p",{children:"No items found."})},o=t(8575),l=t(4201);function c(){let{user:e}=(0,a.a)(!1),r=(0,o.I0)(),{data:t,loading:s,error:c,hasLoaded:u}=(0,o.v9)(e=>e.products);if((0,i.useEffect)(()=>{!e||u||c||r((0,l.t2)())},[e,u,c,r]),!e)return null;let h=null!==t;return(0,n.jsxs)("div",{style:{padding:"2rem",fontFamily:"system-ui"},children:[(0,n.jsx)("h1",{children:"View All Products"}),s&&!h&&(0,n.jsx)("p",{children:"Loading products..."}),c&&(0,n.jsx)("div",{style:{marginTop:"1rem",color:"red"},children:c}),h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{products:t}),(0,n.jsx)("button",{onClick:()=>{r((0,l.t2)())},disabled:s,style:{marginTop:"1rem",padding:"10px",cursor:"pointer"},children:s?"Fetching...":"Fetch Records Again"})]}):!s&&!c&&e&&(0,n.jsx)("p",{children:"No products available."})]})}function u(){return(0,n.jsx)(s.a,{children:(0,n.jsx)(c,{})})}},8365:function(e){"use strict";e.exports=JSON.parse('{"v":{"D":"https://localhost:44367"}}')}},function(e){e.O(0,[519,971,117,744],function(){return e(e.s=8239)}),_N_E=e.O()}]);